# name the compiler
CPP = wpp386
CC = wcc386
WL = wlib
ASM = ml

OBJETS1	=	FASTCPY.OBJ	FASTCPYI.OBJ	FASTCPYF.OBJ	FASTCPYM.OBJ	&
		FASTSET.OBJ	FASTSETI.OBJ	FASTSETF.OBJ	FASTSETM.OBJ	&
		FILES.OBJ	FILECOPY.OBJ	FILEBAK.OBJ	FILENAME.OBJ	&
		N_MALLOC.OBJ	S_MALLOC.OBJ	AVAILMEM.OBJ			&
		LOADMALL.OBJ	LOADSAVE.OBJ	LZ.OBJ				&
		HQMEM.OBJ	HQFILE.OBJ	HQRLOAD.OBJ	HQRMLOAD.OBJ	&
		HQRRESS.OBJ	HQRMEM.OBJ	CPU.OBJ		DISPCPU.OBJ	&
		CHOOSER.OBJ	LOGPRINT.OBJ	EXIT.OBJ	DEFFILE.OBJ	&
		ITOA.OBJ	INITIMER.OBJ	INITKEYB.OBJ	INPUT.OBJ	&
		CMDLINE.OBJ	DISKDIR.OBJ	DISPOS.OBJ

!ifeq BT NT
CFLAGS	= /D_WIN32 /fh=NT.PCH
AFLAGS	= /D_WIN32
LIB     = NT_SYSS
OBJETS2 =	WINSYS.OBJ	PATCH.OBJ	TIMERWIN.OBJ	KEYBWIN.OBJ
!else
CFLAGS	= /D_DOS4GW /fh=DOS.PCH
AFLAGS	= /D_DOS4GW
LIB     = DOS_SYSS
OBJETS2 = 	DOSMALLO.OBJ	A_MALLOC.OBJ	KEYBDOS.OBJ	TIMERDOS.OBJ	&
		DOSSYS.OBJ
!endif

CFLAGS += /6s /d3 /oneatxz /s /wx /mf /hd /DLIB_LOCAL /bt=$(BT) /zp8 /v
LFLAGS  = /c /b /l
AFLAGS += /DSTACK_CALL /nologo /Cx /Zm /Zi /c /WX /Sa /Zd /Cp /omf

#.SILENT

$(LIB).LIB: $(OBJETS1) $(OBJETS2)
	*$(WL) $(LFLAGS) $(LIB) $?

.cpp.obj:
	$(CPP) $* $(CFLAGS)

.c.obj:
	$(CC) $* $(CFLAGS)

.asm.obj:
	$(ASM) $(AFLAGS) $*.ASM
